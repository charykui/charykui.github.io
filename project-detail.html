<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Project Details</title>
  <link rel="stylesheet" href="assets/css/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Navbar -->
  <nav>
    <div class="logo">
      <img src="assets/images/logo.png" alt="Logo" class="logo-img">
    </div>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="resume.html">Resume</a></li>
      <li><a href="projects.html" class="active">Projects</a></li>
      <li><a href="blog.html">Blog</a></li>
      <li><a href="certificates.html">Certificates</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
  </nav>

  <!-- Project Detail -->
  <main>
    <section class="detail-card">
      <a href="projects.html" class="view-link">← Back</a>
      <h1 id="project-title">Loading...</h1>
      <p id="project-description"></p>

      <h2>Objective</h2>
      <p id="project-objective"></p>

      <h2>Steps</h2>
      <ul id="project-steps"></ul>

      <h2>Results</h2>
      <p id="project-results"></p>

      <h2>Screenshots</h2>
      <div id="project-screenshots" class="screenshot-grid"></div>

      <h2>Video Walkthrough</h2>
      <div id="project-video"></div>

      <a href="projects.html" class="view-link">← Back to Projects</a>
    </section>
  </main>
  <!-- Lightbox for screenshots -->
  <div id="lightbox" class="lightbox">
    <span class="close">&times;</span>
    <span class="prev">&#10094;</span>
    <img class="lightbox-content" id="lightbox-img">
    <span class="next">&#10095;</span>
  </div>



  <footer>
    <p>&copy; 2025 Charity Chepkirui | Cybersecurity Portfolio</p>
  </footer>

  <!-- JS to load project -->
  <script>
    async function loadProject() {
      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");

      try {
        const response = await fetch("assets/data/projects.json");
        const data = await response.json();

        let project = null;

        // Search all categories for the project ID
        for (const [category, projects] of Object.entries(data)) {
          if (projects[id]) {
            project = projects[id];
            break;
          }
        }

        if (project) {
          document.getElementById("project-title").textContent = project.title;
          document.getElementById("project-description").textContent = project.description || "";

          document.getElementById("project-objective").textContent = project.objective || "No objective provided.";

          // Steps
          const stepsList = document.getElementById("project-steps");
          stepsList.innerHTML = "";
          if (project.steps) {
            project.steps.forEach(step => {
              const li = document.createElement("li");
              li.textContent = step;
              stepsList.appendChild(li);
            });
          }

          document.getElementById("project-results").textContent = project.results || "No results provided.";

          // Screenshots
          const screenshotDiv = document.getElementById("project-screenshots");
          screenshotDiv.innerHTML = "";
          if (project.screenshots) {
            project.screenshots.forEach(src => {
              const img = document.createElement("img");
              img.src = src;
              img.alt = "Project Screenshot";
              screenshotDiv.appendChild(img);
            });
          }
          // Lightbox for screenshots
          const lightbox = document.getElementById("lightbox");
          const lightboxImg = document.getElementById("lightbox-img");
          const closeBtn = document.querySelector(".lightbox .close");
          const prevBtn = document.querySelector(".lightbox .prev");
          const nextBtn = document.querySelector(".lightbox .next");

          let screenshots = [];
          let currentIndex = 0;

          function openLightbox(index) {
            currentIndex = index;
            lightbox.style.display = "flex";
            lightboxImg.src = screenshots[currentIndex].src;
          }

          function showNext() {
            currentIndex = (currentIndex + 1) % screenshots.length;
            lightboxImg.src = screenshots[currentIndex].src;
          }

          function showPrev() {
            currentIndex = (currentIndex - 1 + screenshots.length) % screenshots.length;
            lightboxImg.src = screenshots[currentIndex].src;
          }

          function closeLightbox() {
            lightbox.style.display = "none";
          }

          closeBtn.addEventListener("click", closeLightbox);
          nextBtn.addEventListener("click", showNext);
          prevBtn.addEventListener("click", showPrev);

          lightbox.addEventListener("click", (e) => {
            if (e.target === lightbox) closeLightbox();
          });

// Attach to screenshots after they are loaded
          setTimeout(() => {
            screenshots = Array.from(document.querySelectorAll("#project-screenshots img"));
            screenshots.forEach((img, index) => {
              img.addEventListener("click", () => openLightbox(index));
            });
          }, 500);


          // Video
          const videoDiv = document.getElementById("project-video");
          videoDiv.innerHTML = "";
          if (project.video) {
            videoDiv.innerHTML = `
            <div class="video-container">
            <iframe width="100%" height="400" src="${project.video}" 
            frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
            allowfullscreen></iframe>
            </div>
            `;
          }

        } else {
          document.querySelector(".detail-card").innerHTML =
            "<h1>Project Not Found</h1><a href='projects.html'>← Back to Projects</a>";
        }
      } catch (error) {
        console.error("Error loading project:", error);
      }
    }

    loadProject();
  </script>
</body>
</html>
